---
// Admin Users Management
export const prerender = false;

import '~/assets/styles/tailwind.css';
import type { AdminUser } from '~/lib/types';
import { canManageUsers } from '~/lib/auth';

const env = Astro.locals.runtime?.env;
const user = Astro.locals.user;
const DB = env?.DB;

// Check permissions
if (!canManageUsers(user?.role)) {
  return Astro.redirect('/admin');
}

let users: Omit<AdminUser, 'password_hash'>[] = [];

if (DB) {
  try {
    let query = `
      SELECT id, email, name, role, notify_contact, notify_applications, last_login, created_at
      FROM admin_users
    `;

    // Role-based filtering
    if (user?.role === 'agency') {
      query += ` WHERE role IN ('agency', 'admin', 'viewer')`;
    } else if (user?.role === 'admin') {
      query += ` WHERE role IN ('admin', 'viewer')`;
    }

    query += ' ORDER BY role, name';

    const result = await DB.prepare(query).all();
    users = (result.results || []) as Omit<AdminUser, 'password_hash'>[];
  } catch (error) {
    console.error('Users load error:', error);
  }
}

// Determine which roles this user can create
const roleHierarchy = { superadmin: 4, agency: 3, admin: 2, viewer: 1 };
const userLevel = roleHierarchy[user?.role as keyof typeof roleHierarchy] || 0;

const availableRoles = Object.entries(roleHierarchy)
  .filter(([, level]) => level <= userLevel)
  .filter(([role]) => role !== 'superadmin' || user?.role === 'superadmin')
  .map(([role]) => role);

function formatDate(dateStr: string | null) {
  if (!dateStr) return 'Never';
  return new Date(dateStr).toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric',
    year: 'numeric',
  });
}

function getRoleLabel(role: string) {
  const labels: Record<string, string> = {
    superadmin: 'Super Admin',
    agency: 'Agency',
    admin: 'Admin',
    viewer: 'Viewer',
  };
  return labels[role] || role;
}

function getRoleColor(role: string) {
  const colors: Record<string, string> = {
    superadmin: 'bg-purple-100 text-purple-800',
    agency: 'bg-blue-100 text-blue-800',
    admin: 'bg-green-100 text-green-800',
    viewer: 'bg-gray-100 text-gray-800',
  };
  return colors[role] || 'bg-gray-100 text-gray-800';
}
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Users - Admin - MTN MUD</title>
    <meta name="robots" content="noindex, nofollow" />
  </head>
  <body class="bg-gray-100 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-[#1a1a2e] text-white shadow-lg">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16 items-center">
          <div class="flex items-center gap-8">
            <a href="/admin" class="font-black text-xl text-[#ff6600]">MTN MUD</a>
            <div class="hidden md:flex gap-6">
              <a href="/admin" class="text-gray-300 hover:text-white">Dashboard</a>
              <a href="/admin/products" class="text-gray-300 hover:text-white">Products</a>
              <a href="/admin/jobs" class="text-gray-300 hover:text-white">Jobs</a>
              <a href="/admin/submissions" class="text-gray-300 hover:text-white">Submissions</a>
              <a href="/admin/users" class="text-white font-medium">Users</a>
            </div>
          </div>
          <div class="hidden md:flex items-center gap-4">
            <button id="settingsBtn" class="text-gray-300 hover:text-white text-sm">Settings</button>
            <span class="text-gray-400 text-sm">{user?.name}</span>
            <a href="/api/admin/logout" class="text-gray-300 hover:text-white text-sm bg-gray-800 px-3 py-1.5 rounded">
              Logout
            </a>
          </div>
          <!-- Mobile menu button -->
          <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg hover:bg-gray-800" aria-label="Toggle menu">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path
                id="menuIconOpen"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4 6h16M4 12h16M4 18h16"></path>
              <path
                id="menuIconClose"
                class="hidden"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>
      <!-- Mobile menu -->
      <div id="mobileMenu" class="hidden md:hidden border-t border-gray-700">
        <div class="px-4 py-3 space-y-2">
          <a href="/admin" class="block px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white"
            >Dashboard</a
          >
          <a href="/admin/products" class="block px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white"
            >Products</a
          >
          <a href="/admin/jobs" class="block px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white"
            >Jobs</a
          >
          <a
            href="/admin/submissions"
            class="block px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white">Submissions</a
          >
          <a href="/admin/users" class="block px-3 py-2 rounded-lg bg-gray-800 text-white font-medium">Users</a>
          <button
            id="settingsBtnMobile"
            class="block w-full text-left px-3 py-2 rounded-lg text-gray-300 hover:bg-gray-800 hover:text-white"
            >Settings</button
          >
          <div class="border-t border-gray-700 pt-2 mt-2">
            <div class="px-3 py-2 text-gray-400 text-sm">{user?.name}</div>
            <a
              href="/api/admin/logout"
              class="block px-3 py-2 rounded-lg text-red-400 hover:bg-gray-800 hover:text-red-300">Logout</a
            >
          </div>
        </div>
      </div>
    </nav>

    <script>
      const mobileMenuBtn = document.getElementById('mobileMenuBtn');
      const mobileMenu = document.getElementById('mobileMenu');
      const menuIconOpen = document.getElementById('menuIconOpen');
      const menuIconClose = document.getElementById('menuIconClose');

      mobileMenuBtn?.addEventListener('click', () => {
        mobileMenu?.classList.toggle('hidden');
        menuIconOpen?.classList.toggle('hidden');
        menuIconClose?.classList.toggle('hidden');
      });
    </script>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <!-- Header -->
      <div class="flex justify-between items-center mb-8">
        <div>
          <h1 class="text-2xl font-bold text-gray-900">User Management</h1>
          <p class="text-gray-600">{users.length} users</p>
        </div>
        <button
          id="addUserBtn"
          class="bg-[#ff6600] hover:bg-[#ff7700] text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
          </svg>
          Add User
        </button>
      </div>

      <!-- Role Hierarchy Info -->
      <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
        <h3 class="font-medium text-blue-800 mb-2">Role Hierarchy</h3>
        <ul class="text-sm text-blue-700 space-y-1">
          <li><strong>Super Admin:</strong> Full access, can manage all users</li>
          <li><strong>Agency:</strong> Can manage agency users, admins, and viewers</li>
          <li><strong>Admin:</strong> Can manage products, jobs, and viewer accounts</li>
          <li><strong>Viewer:</strong> Read-only access to admin dashboard</li>
        </ul>
      </div>

      <!-- Users Table (Desktop) -->
      <div class="hidden md:block bg-white rounded-xl shadow overflow-hidden">
        <table class="w-full">
          <thead class="bg-gray-50">
            <tr>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"
                >Notifications</th
              >
              <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Last Login</th>
              <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200">
            {
              users.map((u) => {
                const canEditUser =
                  user?.id === u.id ||
                  (roleHierarchy[user?.role as keyof typeof roleHierarchy] || 0) >
                    (roleHierarchy[u.role as keyof typeof roleHierarchy] || 0);
                const canDeleteUser =
                  user?.id !== u.id &&
                  (roleHierarchy[user?.role as keyof typeof roleHierarchy] || 0) >
                    (roleHierarchy[u.role as keyof typeof roleHierarchy] || 0);

                return (
                  <tr class="hover:bg-gray-50">
                    <td class="px-6 py-4">
                      <div class="font-medium text-gray-900">
                        {u.name}
                        {u.id === user?.id && (
                          <span class="ml-2 text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded">You</span>
                        )}
                      </div>
                      <div class="text-sm text-gray-500">{u.email}</div>
                    </td>
                    <td class="px-6 py-4">
                      <span class={`inline-flex px-2 py-1 text-xs font-medium rounded ${getRoleColor(u.role)}`}>
                        {getRoleLabel(u.role)}
                      </span>
                    </td>
                    <td class="px-6 py-4">
                      <div class="flex gap-2">
                        {u.notify_contact === 1 && (
                          <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">Contact</span>
                        )}
                        {u.notify_applications === 1 && (
                          <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded">Applications</span>
                        )}
                        {u.notify_contact !== 1 && u.notify_applications !== 1 && (
                          <span class="text-xs text-gray-400">None</span>
                        )}
                      </div>
                    </td>
                    <td class="px-6 py-4 text-gray-600 text-sm">{formatDate(u.last_login)}</td>
                    <td class="px-6 py-4 text-right">
                      {canEditUser && (
                        <button
                          class="text-[#ff6600] hover:text-[#ff7700] font-medium mr-3 edit-btn"
                          data-id={u.id}
                          data-user={JSON.stringify(u)}
                        >
                          Edit
                        </button>
                      )}
                      {canDeleteUser && (
                        <button class="text-red-600 hover:text-red-700 font-medium delete-btn" data-id={u.id}>
                          Delete
                        </button>
                      )}
                    </td>
                  </tr>
                );
              })
            }
          </tbody>
        </table>

        {
          users.length === 0 && (
            <div class="px-6 py-12 text-center text-gray-500">
              <p>No users found</p>
            </div>
          )
        }
      </div>

      <!-- Users Cards (Mobile) -->
      <div class="md:hidden space-y-4">
        {
          users.map((u) => {
            const canEditUser =
              user?.id === u.id ||
              (roleHierarchy[user?.role as keyof typeof roleHierarchy] || 0) >
                (roleHierarchy[u.role as keyof typeof roleHierarchy] || 0);
            const canDeleteUser =
              user?.id !== u.id &&
              (roleHierarchy[user?.role as keyof typeof roleHierarchy] || 0) >
                (roleHierarchy[u.role as keyof typeof roleHierarchy] || 0);

            return (
              <div class="bg-white rounded-xl shadow p-4">
                <div class="flex justify-between items-start mb-2">
                  <div>
                    <h3 class="font-semibold text-gray-900">
                      {u.name}
                      {u.id === user?.id && (
                        <span class="ml-2 text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded">You</span>
                      )}
                    </h3>
                    <p class="text-sm text-gray-500">{u.email}</p>
                  </div>
                  <span class={`inline-flex px-2 py-1 text-xs font-medium rounded ${getRoleColor(u.role)}`}>
                    {getRoleLabel(u.role)}
                  </span>
                </div>
                <div class="flex flex-wrap gap-2 text-xs mb-3">
                  {u.notify_contact === 1 && <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded">Contact</span>}
                  {u.notify_applications === 1 && (
                    <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded">Applications</span>
                  )}
                  {u.notify_contact !== 1 && u.notify_applications !== 1 && (
                    <span class="text-gray-400">No notifications</span>
                  )}
                </div>
                <div class="flex items-center justify-between pt-3 border-t border-gray-100">
                  <span class="text-xs text-gray-500">Last login: {formatDate(u.last_login)}</span>
                  <div class="flex gap-3">
                    {canEditUser && (
                      <button
                        class="text-[#ff6600] hover:text-[#ff7700] font-medium text-sm edit-btn"
                        data-id={u.id}
                        data-user={JSON.stringify(u)}
                      >
                        Edit
                      </button>
                    )}
                    {canDeleteUser && (
                      <button class="text-red-600 hover:text-red-700 font-medium text-sm delete-btn" data-id={u.id}>
                        Delete
                      </button>
                    )}
                  </div>
                </div>
              </div>
            );
          })
        }
        {
          users.length === 0 && (
            <div class="bg-white rounded-xl shadow px-6 py-12 text-center text-gray-500">
              <p>No users found</p>
            </div>
          )
        }
      </div>
    </main>

    <!-- User Modal -->
    <div id="userModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto">
        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 id="modalTitle" class="text-lg font-semibold text-gray-900">Add User</h2>
          <button id="closeModal" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <form id="userForm" class="p-6 space-y-4">
          <input type="hidden" id="userId" />

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Name *</label>
            <input
              type="text"
              id="userName"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email *</label>
            <input
              type="email"
              id="userEmail"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">
              Password <span id="passwordHint" class="text-gray-400 font-normal">(leave blank to keep current)</span>
            </label>
            <input
              type="password"
              id="userPassword"
              minlength="8"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>

          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Role *</label>
            <select
              id="userRole"
              required
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            >
              {availableRoles.map((role) => <option value={role}>{getRoleLabel(role)}</option>)}
            </select>
          </div>

          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700">Email Notifications</label>
            <div class="flex items-center gap-2">
              <input type="checkbox" id="notifyContact" class="w-4 h-4 text-[#ff6600] rounded" />
              <label for="notifyContact" class="text-sm text-gray-700">Contact form submissions</label>
            </div>
            <div class="flex items-center gap-2">
              <input type="checkbox" id="notifyApplications" class="w-4 h-4 text-[#ff6600] rounded" />
              <label for="notifyApplications" class="text-sm text-gray-700">Job applications</label>
            </div>
          </div>

          <div id="errorMessage" class="hidden text-red-600 text-sm bg-red-50 p-3 rounded-lg"></div>

          <div class="flex justify-end gap-3 pt-4">
            <button type="button" id="cancelBtn" class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg">
              Cancel
            </button>
            <button type="submit" class="px-4 py-2 bg-[#ff6600] hover:bg-[#ff7700] text-white rounded-lg font-medium">
              Save User
            </button>
          </div>
        </form>
      </div>
    </div>

    <script
      define:vars={{
        currentUserId: user?.id,
        currentUser: {
          id: user?.id,
          name: user?.name,
          email: user?.email,
          notify_contact: user?.notify_contact,
          notify_applications: user?.notify_applications,
        },
      }}
    >
      const modal = document.getElementById('userModal');
      const form = document.getElementById('userForm');
      const errorMessage = document.getElementById('errorMessage');
      const passwordHint = document.getElementById('passwordHint');

      // Open add modal
      document.getElementById('addUserBtn')?.addEventListener('click', () => {
        document.getElementById('modalTitle').textContent = 'Add User';
        document.getElementById('userId').value = '';
        form.reset();
        passwordHint.classList.add('hidden');
        document.getElementById('userPassword').required = true;
        modal.classList.remove('hidden');
        modal.classList.add('flex');
      });

      // Edit buttons
      document.querySelectorAll('.edit-btn').forEach((btn) => {
        btn.addEventListener('click', () => {
          const u = JSON.parse(btn.dataset.user);
          document.getElementById('modalTitle').textContent = 'Edit User';
          document.getElementById('userId').value = u.id;
          document.getElementById('userName').value = u.name;
          document.getElementById('userEmail').value = u.email;
          document.getElementById('userPassword').value = '';
          document.getElementById('userRole').value = u.role;
          document.getElementById('notifyContact').checked = u.notify_contact === 1;
          document.getElementById('notifyApplications').checked = u.notify_applications === 1;

          passwordHint.classList.remove('hidden');
          document.getElementById('userPassword').required = false;

          modal.classList.remove('hidden');
          modal.classList.add('flex');
        });
      });

      // Delete buttons
      document.querySelectorAll('.delete-btn').forEach((btn) => {
        btn.addEventListener('click', async () => {
          // Prevent users from deleting themselves
          if (btn.dataset.id === currentUserId) {
            alert('You cannot delete your own account');
            return;
          }
          if (!confirm('Are you sure you want to delete this user? This cannot be undone.')) return;

          try {
            const response = await fetch(`/api/admin/users/${btn.dataset.id}`, {
              method: 'DELETE',
            });
            if (response.ok) {
              window.location.reload();
            } else {
              const data = await response.json();
              alert(data.error || 'Failed to delete user');
            }
          } catch {
            alert('Failed to delete user');
          }
        });
      });

      // Close modal
      function closeModal() {
        modal.classList.add('hidden');
        modal.classList.remove('flex');
        errorMessage.classList.add('hidden');
      }

      document.getElementById('closeModal')?.addEventListener('click', closeModal);
      document.getElementById('cancelBtn')?.addEventListener('click', closeModal);

      // Submit form
      form?.addEventListener('submit', async (e) => {
        e.preventDefault();
        errorMessage.classList.add('hidden');

        const id = document.getElementById('userId').value;
        const data = {
          name: document.getElementById('userName').value,
          email: document.getElementById('userEmail').value,
          role: document.getElementById('userRole').value,
          notify_contact: document.getElementById('notifyContact').checked,
          notify_applications: document.getElementById('notifyApplications').checked,
        };

        const password = document.getElementById('userPassword').value;
        if (password) {
          data.password = password;
        }

        try {
          const url = id ? `/api/admin/users/${id}` : '/api/admin/users';
          const method = id ? 'PUT' : 'POST';

          const response = await fetch(url, {
            method,
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          });

          const result = await response.json();

          if (response.ok && (result.success || result.user)) {
            window.location.reload();
          } else {
            errorMessage.textContent = result.error || 'Failed to save user';
            errorMessage.classList.remove('hidden');
          }
        } catch {
          errorMessage.textContent = 'Connection error';
          errorMessage.classList.remove('hidden');
        }
      });

      // Settings modal
      const settingsModal = document.getElementById('settingsModal');
      const settingsForm = document.getElementById('settingsForm');
      const settingsError = document.getElementById('settingsError');
      const settingsSuccess = document.getElementById('settingsSuccess');

      function openSettingsModal() {
        document.getElementById('settingsName').value = currentUser.name || '';
        document.getElementById('settingsEmail').value = currentUser.email || '';
        document.getElementById('settingsPassword').value = '';
        document.getElementById('settingsNotifyContact').checked = currentUser.notify_contact === 1;
        document.getElementById('settingsNotifyApplications').checked = currentUser.notify_applications === 1;
        settingsError.classList.add('hidden');
        settingsSuccess.classList.add('hidden');
        settingsModal.classList.remove('hidden');
        settingsModal.classList.add('flex');
      }

      function closeSettingsModal() {
        settingsModal.classList.add('hidden');
        settingsModal.classList.remove('flex');
      }

      document.getElementById('settingsBtn')?.addEventListener('click', openSettingsModal);
      document.getElementById('settingsBtnMobile')?.addEventListener('click', openSettingsModal);
      document.getElementById('closeSettingsModal')?.addEventListener('click', closeSettingsModal);
      document.getElementById('cancelSettingsBtn')?.addEventListener('click', closeSettingsModal);

      settingsForm?.addEventListener('submit', async (e) => {
        e.preventDefault();
        settingsError.classList.add('hidden');
        settingsSuccess.classList.add('hidden');

        const data = {
          name: document.getElementById('settingsName').value,
          email: document.getElementById('settingsEmail').value,
          notify_contact: document.getElementById('settingsNotifyContact').checked,
          notify_applications: document.getElementById('settingsNotifyApplications').checked,
        };

        const password = document.getElementById('settingsPassword').value;
        if (password) {
          if (password.length < 8) {
            settingsError.textContent = 'Password must be at least 8 characters';
            settingsError.classList.remove('hidden');
            return;
          }
          data.password = password;
        }

        try {
          const response = await fetch(`/api/admin/users/${currentUser.id}`, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          });

          const result = await response.json();

          if (response.ok && result.success) {
            settingsSuccess.textContent = 'Settings saved successfully!';
            settingsSuccess.classList.remove('hidden');
            setTimeout(() => window.location.reload(), 1000);
          } else {
            settingsError.textContent = result.error || 'Failed to save settings';
            settingsError.classList.remove('hidden');
          }
        } catch {
          settingsError.textContent = 'Connection error';
          settingsError.classList.remove('hidden');
        }
      });
    </script>

    <!-- Settings Modal -->
    <div id="settingsModal" class="fixed inset-0 bg-black/50 hidden items-center justify-center z-50">
      <div class="bg-white rounded-xl shadow-2xl w-full max-w-md mx-4">
        <div class="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
          <h2 class="text-lg font-semibold text-gray-900">Account Settings</h2>
          <button id="closeSettingsModal" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
        <form id="settingsForm" class="p-6 space-y-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Name</label>
            <input
              type="text"
              id="settingsName"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
            <input
              type="email"
              id="settingsEmail"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1"
              >New Password <span class="text-gray-400 font-normal">(leave blank to keep current)</span></label
            >
            <input
              type="password"
              id="settingsPassword"
              minlength="8"
              placeholder="Enter new password"
              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff6600] focus:border-transparent"
            />
          </div>
          <div class="space-y-2">
            <label class="block text-sm font-medium text-gray-700">Email Notifications</label>
            <div class="flex items-center gap-2">
              <input type="checkbox" id="settingsNotifyContact" class="w-4 h-4 text-[#ff6600] rounded" />
              <label for="settingsNotifyContact" class="text-sm text-gray-700">Contact form submissions</label>
            </div>
            <div class="flex items-center gap-2">
              <input type="checkbox" id="settingsNotifyApplications" class="w-4 h-4 text-[#ff6600] rounded" />
              <label for="settingsNotifyApplications" class="text-sm text-gray-700">Job applications</label>
            </div>
          </div>
          <div id="settingsError" class="hidden text-red-600 text-sm bg-red-50 p-3 rounded-lg"></div>
          <div id="settingsSuccess" class="hidden text-green-600 text-sm bg-green-50 p-3 rounded-lg"></div>
          <div class="flex justify-end gap-3 pt-4">
            <button type="button" id="cancelSettingsBtn" class="px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg"
              >Cancel</button
            >
            <button type="submit" class="px-4 py-2 bg-[#ff6600] hover:bg-[#ff7700] text-white rounded-lg font-medium"
              >Save Changes</button
            >
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
